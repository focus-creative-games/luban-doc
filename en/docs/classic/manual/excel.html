<!doctype html>
<html lang="en-us" dir="ltr" class="docs-wrapper docs-doc-page docs-version-classic plugin-docs plugin-id-default docs-doc-id-manual/excel">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">excel格式介绍 | Luban</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luban.doc.code-philosophy.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://luban.doc.code-philosophy.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://luban.doc.code-philosophy.com/en/docs/classic/manual/excel"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="classic"><meta data-rh="true" name="docusaurus_tag" content="docs-default-classic"><meta data-rh="true" name="docsearch:version" content="classic"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-classic"><meta data-rh="true" property="og:title" content="excel格式介绍 | Luban"><meta data-rh="true" name="description" content="创建一个普通的xlsx 配置表"><meta data-rh="true" property="og:description" content="创建一个普通的xlsx 配置表"><link data-rh="true" rel="icon" href="/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://luban.doc.code-philosophy.com/en/docs/classic/manual/excel"><link data-rh="true" rel="alternate" href="https://luban.doc.code-philosophy.com/docs/classic/manual/excel" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://luban.doc.code-philosophy.com/en/docs/classic/manual/excel" hreflang="en-us"><link data-rh="true" rel="alternate" href="https://luban.doc.code-philosophy.com/docs/classic/manual/excel" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7OJETCEDBD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Luban" href="/en/opensearch.xml"><link rel="stylesheet" href="/en/assets/css/styles.63be808c.css">
<link rel="preload" href="/en/assets/js/runtime~main.6220c242.js" as="script">
<link rel="preload" href="/en/assets/js/main.72f07b5a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Luban</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/classic/intro">Document</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/classic/intro">classic</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/docs/manual/excel">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/classic/manual/excel">classic</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/classic/manual/excel" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">中文</a></li><li><a href="/en/docs/classic/manual/excel" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-us">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/classic/intro">介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/classic/beginner">新手教程</a><button aria-label="Toggle the collapsible sidebar category &#x27;新手教程&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/beginner/quickstart">快速上手</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/classic/basic">使用指南</a><button aria-label="Toggle the collapsible sidebar category &#x27;使用指南&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/traits">特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/commandtools">命令行工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/deploy">服务端布署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/generatecodedata">代码与数据生成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/define">配置定义</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/classic/manual/excel">excel格式介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/loadconfigatruntime">运行时加载配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/excelsep">sep 介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/validator">检验器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/dynamicbean">多态类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/template">自定义模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/tag">tag 介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/datasource">数据定义</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/editor">Editor支持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/convert">源数据转换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/l10n">本地化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/classic/manual/bestpractices">最佳实践</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/classic/help/faq">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/classic/other">其他</a><button aria-label="Toggle the collapsible sidebar category &#x27;其他&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Luban<!-- --> <b>classic</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/en/docs/manual/excel">latest version</a></b> (<!-- -->Next<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/classic/basic"><span itemprop="name">使用指南</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">excel格式介绍</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: classic</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>excel格式介绍</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建一个普通的xlsx-配置表">创建一个普通的xlsx 配置表<a href="#创建一个普通的xlsx-配置表" class="hash-link" aria-label="Direct link to 创建一个普通的xlsx 配置表" title="Direct link to 创建一个普通的xlsx 配置表">​</a></h2><ul><li>假设你要创建的配置为装备表.</li><li>在MyConfigs/Datas 目录下创建 equip.xlsx（实践中推荐按模块创建子目录，在模块目录创建配置，便于维护管理）, 其内容如下</li></ul><table><thead><tr><th>##var</th><th>id</th><th>name</th><th>attr</th><th>value</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>string</td><td>int</td><td>float</td></tr><tr><td>##group</td><td>c</td><td>s</td><td>c,s</td><td></td></tr><tr><td></td><td>1</td><td>equip1</td><td>10</td><td>1.2</td></tr><tr><td></td><td>2</td><td>equip2</td><td>15</td><td>3.4</td></tr></tbody></table><ul><li>在 MyConfigs/Datas/<!-- -->_<!-- -->_<!-- -->tables<!-- -->_<!-- -->_<!-- -->.xlsx 里新增一行。 有些不相关列被忽略了</li></ul><table><thead><tr><th>##var</th><th>full_name</th><th>value_type</th><th>define_from_excel</th><th>input</th><th>...</th></tr></thead><tbody><tr><td></td><td>demo.TbItem</td><td>Item</td><td>true</td><td>equip.xlsx</td><td></td></tr></tbody></table><ul><li>至此，完成添加新表工具。 运行 check.bat 检查是否成功生成！</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="excel-标题头行的介绍">excel 标题头行的介绍<a href="#excel-标题头行的介绍" class="hash-link" aria-label="Direct link to excel 标题头行的介绍" title="Direct link to excel 标题头行的介绍">​</a></h2><ul><li>第1列单元格为 <code>##var</code> 表示这行是字段定义行</li><li>第1列单元格为 <code>##type</code> 表示这行是 类型定义行</li><li>第1列单元格为 <code>##group</code> 表示这行是 导出分组行。<strong>此行可选</strong>。另外，单元格留空表示对所有分组导出。</li><li>第1列单元格以##<strong>开头</strong> 表示这是注释行，如果有多个##行，默认以第一个行作为代码中字段的注释，你可以通过##comment 显式指定某行为代码注释行。</li><li>填写多级字段名行时，以##var表示这是次级字段行</li><li>你可以随意调整##xxx和##yyy之类的行的顺序，<strong>但注意</strong> 如果第一行是注释行，必须使用##comment，而不是##。否则会把第一行当字段名行而出错（这是出于兼容性，早期强制第一行是字段名行，允许只以##开头）</li></ul><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="6">*stages</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>id</td><td>name</td><td>desc</td><td>location</td><td>item_id</td><td>num</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="6">list,Stage</td></tr><tr align="center"><td>##</td><td>id</td><td>desc1</td><td>desc1</td><td>desc2</td><td>desc3</td><td>desc4</td><td>desc5</td><td>desc6</td></tr><tr align="center"><td>##comment</td><td>id</td><td>名字</td><td>注释1</td><td>desc2</td><td>desc3</td><td>desc4</td><td>desc5</td><td>desc6</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>3</td><td>stage3</td><td>stage desc3</td><td>1,2,3</td><td>1002</td><td>1</td></tr><tr align="center"><td></td><td>2</td><td>task2</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1002</td><td>1</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="注释行或列">注释行或列<a href="#注释行或列" class="hash-link" aria-label="Direct link to 注释行或列" title="Direct link to 注释行或列">​</a></h2><p>当标题行字段名为空或者以&#x27;#&#x27;、&#x27;_&#x27;开头时，这个列会被当作注释列而忽略。</p><p>当数据行的第一列以##开头时，这一行会被当作注释行而被忽略。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="excel文件-读取规则">excel文件 读取规则<a href="#excel文件-读取规则" class="hash-link" aria-label="Direct link to excel文件 读取规则" title="Direct link to excel文件 读取规则">​</a></h2><ul><li>如果未指定sheet，则默认会读取所有sheet</li><li>可以用 <a href="mailto:sheet@xxx.xlsx" target="_blank" rel="noopener noreferrer">sheet@xxx.xlsx</a> 指定只读入这个sheet数据</li><li>如果A1单元格数据不以##开头，则会被当作非数据sheet，被忽略</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="支持的excel文件族">支持的excel文件族<a href="#支持的excel文件族" class="hash-link" aria-label="Direct link to 支持的excel文件族" title="Direct link to 支持的excel文件族">​</a></h2><p>支持 xls、 xlsx、 xlm、 xlmx、csv 。基本上excel能打开的都可以读取。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="支持非gkb和utf-8编码的csv文件">支持非GKB和UTF-8编码的csv文件<a href="#支持非gkb和utf-8编码的csv文件" class="hash-link" aria-label="Direct link to 支持非GKB和UTF-8编码的csv文件" title="Direct link to 支持非GKB和UTF-8编码的csv文件">​</a></h2><p>luban会智能猜测出它的编码，正确处理。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="灵活的配置文件组织形式">灵活的配置文件组织形式<a href="#灵活的配置文件组织形式" class="hash-link" aria-label="Direct link to 灵活的配置文件组织形式" title="Direct link to 灵活的配置文件组织形式">​</a></h2><ul><li>可以几个表都放到一个xlsx中，每个表占一个sheet。 只需要为每个表的input指定为该单元薄即可，如 input=&quot;xxx@item/test/abs.xlsx&quot;。</li><li>可以一个表拆分为几个xlsx。 如 input=&quot;item/a.xlsx,bag/b.xlsx,c.xlsx&quot;。</li><li>可以一个读入一个目录下的所有xlsx。 如 input=&quot;bag&quot; 。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="单元格留空取默认值">单元格留空取默认值<a href="#单元格留空取默认值" class="hash-link" aria-label="Direct link to 单元格留空取默认值" title="Direct link to 单元格留空取默认值">​</a></h2><p>除了bean以外的数据，都可以留空。自动取默认值。注意非空字段的默认值是初始值，可空变量的默认值为null。例如int默认值是0，但int?的默认值是null。字符串string的默认值是长度为0的空白字符串，而string?的默认为null。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据格式">数据格式<a href="#数据格式" class="hash-link" aria-label="Direct link to 数据格式" title="Direct link to 数据格式">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="限定列格式与流式格式">限定列格式与流式格式<a href="#限定列格式与流式格式" class="hash-link" aria-label="Direct link to 限定列格式与流式格式" title="Direct link to 限定列格式与流式格式">​</a></h2><p>如果某个字段通过标题头或者多级标题头限定了列范围，它的解析格式为限定列格式。</p><p>如果某个字段只是某个限定列格式的字段的某一个子数据，它的解析格式为流式格式。</p><p>示例如下。 标注@的列为 限定列格式， 标注~的列为流式格式。</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Item</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">num</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="3">item</td> <td colspan="8">items</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="3">Item</td><td colspan="8">list,Item</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>item_id</td><td>num</td><td>desc</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr align="center"><td></td><td>@</td><td>@</td><td>@</td><td>@</td><td>@</td><td>~</td><td>~</td><td>~</td><td>~</td><td>~</td><td>~</td><td>~</td><td>~</td></tr><tr><td></td><td>1</td><td>xxxx</td><td>1001</td><td>1</td><td>item 1</td><td>2001</td><td>1</td><td>item2</td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>2</td><td>xxxx</td><td>1002</td><td>3</td><td>item 1</td><td>2001</td><td>1</td><td>item2</td><td>2002</td><td>2</td><td>item 2</td><td></td><td></td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="限定列格式介绍">限定列格式介绍<a href="#限定列格式介绍" class="hash-link" aria-label="Direct link to 限定列格式介绍" title="Direct link to 限定列格式介绍">​</a></h2><p>通过标题行及多级标题行，可以精确限定某个数据在某些列范围内。</p><p>对于只有一个原子值的简单类型数据，限定列格式下，由于能够非常清晰知道它的值必然来自某一单元格，所以它支持<strong>默认值</strong>语义，即如果单元格为空，值取默认值，例如 int类型默认值为0，int?默认值为null。</p><p>限定列格式下，多态bean类型需要用 $type 列来指定具体类型名，可空bean类型也需要用$type列来指示是有效bean还是空bean。</p><p>如果最低层的限定列的类型为容器或者bean，由于限定列只限定了该数据整体范围，但<strong>未限定</strong>子数据的范围，因此读取子数据的格式为<strong>流式格式</strong>，即按顺序读入每个子数据。</p><p>综合示例如下：</p><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="4">shape</td><td colspan="4">item</td></tr><tr align="center"><td>##type</td><td>int</td><td colspan="4">Shape</td><td colspan="4">Item?</td></tr><tr align="center"><td>##var</td><td></td><td>$type</td><td>radius</td><td>width</td><td>height</td><td>$type</td><td>item_id</td><td>num</td><td>desc</td></tr><tr align="center"><td></td><td>1</td><td>Circle</td><td>10</td><td></td><td></td><td>Item</td><td>1001</td><td>1</td><td>item 1</td></tr><tr align="center"><td></td><td>2</td><td>Rectangle</td><td></td><td>10</td><td>20</td><td></td><td>1001</td><td>2</td><td>item 1</td></tr><tr align="center"><td></td><td>3</td><td>圆</td><td>10</td><td></td><td></td><td>null</td><td></td><td></td><td></td></tr><tr align="center"><td></td><td>4</td><td>Circle</td><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table><p>一些数据结构有特殊的列限定支持。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flags1-的-enum-类型支持列限定模式"><code>flags=1</code> 的 enum 类型支持列限定模式。<a href="#flags1-的-enum-类型支持列限定模式" class="hash-link" aria-label="Direct link to flags1-的-enum-类型支持列限定模式" title="Direct link to flags1-的-enum-类型支持列限定模式">​</a></h3><p>用枚举项作为列名，最终值为所有非0或空的枚举项的或值。</p><table border="1"><tr align="center"><td>##var</td><td colspan="4">type</td> </tr><tr align="center"><td>##var</td><td>A</td><td>B</td><td>C</td><td>D</td></tr><tr align="center"><td></td><td></td><td>1</td><td>1</td><td></td></tr><tr align="center"><td></td><td>1</td><td></td><td></td><td>1</td></tr></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="多态bean支持-type与value-分别配置的列限定或流式格式的混合填写方式">多态bean支持 $type与$value 分别配置的列限定或流式格式的混合填写方式<a href="#多态bean支持-type与value-分别配置的列限定或流式格式的混合填写方式" class="hash-link" aria-label="Direct link to 多态bean支持 $type与$value 分别配置的列限定或流式格式的混合填写方式" title="Direct link to 多态bean支持 $type与$value 分别配置的列限定或流式格式的混合填写方式">​</a></h3><p>即用$type列为限定类型，用$value列来限定bean的实际字段，并且$value中以流式填写bean的所有字段。</p><table border="1"><tr align="center"><td>##var</td><td colspan="4">shape</td> </tr><tr align="center"><td>##var</td><td>$type</td><td colspan="3">$value</td></tr><tr align="center"><td></td><td>Circle</td><td colspan="3">10</td></tr><tr align="center"><td></td><td>Rectangle</td><td colspan="3">10,20</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="流式格式介绍">流式格式介绍<a href="#流式格式介绍" class="hash-link" aria-label="Direct link to 流式格式介绍" title="Direct link to 流式格式介绍">​</a></h2><p>对于没有具体限定列范围的子数据，使用流式格式（也只有这种办法），按顺序读入子数据。</p><p>由于流式格式无法区分 默认单元格和空白忽略单元格，因此流格式下，不支持<strong>默认值</strong>语义，会忽略所有空白单元格。
进而对于默认值必须填上有效值默认值来表示数据，而不能留空来表达。</p><p>流式格式下的默认值填写规则如下</p><ul><li>bool 默认值为 false</li><li>int,float 之类的默认值为 0</li><li>string 的默认值为&quot;&quot;</li><li>可空变量，如int? 的空值为 null</li><li>容器变量，需要有右大括号 &#x27;}&#x27; 来表示空值（用&#x27;}&#x27;表示容器终止）</li></ul><p>如下图，item字段为Item类型，包括多个子数据，但没为它的子字段添加子列限定，因此使用流式格式解析它。</p><ul><li>id=1的列，所有字段能够正常识别</li><li>id=2的列，第2个单元格为空，被忽略，因此试图将&quot;item 1&quot;当作num字段解析，抛出格式错误的异常。</li><li>id=3的列，第3个单元格为空，被忽略，尽管desc字段是string值，能接受空白值，也会抛出 数据缺失的异常。</li></ul><p>记录2和3的正确填法如4和5。</p><table border="1"><tr align="center"> <td>##var</td><td>id</td><td>name</td><td colspan="3">item</td> </tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="3">Item</td></tr><tr align="center"><td></td><td>@</td><td>@</td><td>~</td><td>~</td><td>~</td></tr><tr><td></td><td>1</td><td>xxxx</td><td>1001</td><td>1</td><td>item 1</td> </tr><tr><td></td><td>2</td><td>xxxx</td><td>1001</td><td></td><td>item 1</td> </tr><tr><td></td><td>3</td><td>xxxx</td><td>1001</td><td>1</td><td></td> </tr><tr><td></td><td>2</td><td>xxxx</td><td>1001</td><td>0</td><td>item 1</td> </tr><tr><td></td><td>3</td><td>xxxx</td><td>1001</td><td>1</td><td>&quot;&quot;</td></tr></table><p>流式格式下，各个类型必须填写非空白值，规则如下</p><ul><li>bool  false,true</li><li>int,float 之类  有效整数值</li><li>string  用&quot;&quot;表示长度为0的字符串，用其他非值表示值本身</li><li>enum  非空有效值</li><li>bean 用流式格式按顺序读入每个字段</li><li>多态bean类型 先读入一个字符串，可以是具体的子类名或者子类别名，然后再根据子类名，流式读入该类型的每个字段。</li><li>可空bean类型 先读入一个字符串，如果是bean的类型名或者&#x27;{}&#x27;，则流格式读入该类型的所有字段；如果为null，则表示空，结束读取；其他情况则抛出解析失败的异常。</li><li>array,list,set 如果流结束或者下一个读入的为&#x27;}&#x27;，则读取结束，否则用流格式读入element_type，如此循环。</li><li>map 如果流结束或者下一个读入的为&#x27;}&#x27;，则读取结束，否则递归读入key_type和value_type，如此循环。</li></ul><p>以下是一个非常复杂的bean的流式读取示例</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Foo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">y</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">SubList</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">a</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">b</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">list,string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">c</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">bool</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">StreamDemo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Foo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x2_1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x2_2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">list,int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x3_1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x4</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">list,Foo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x4_1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x5</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">SubList</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x5_1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x7</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">list,SubList</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x7_1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x8_0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">map,int,int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">x8</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="Excel"><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="50">stream_demo</td> </tr><tr align="center"><td>##type</td><td>int</td><td colspan="50">StreamDemo</td></tr><tr align="center"><td>##</td><td></td><td>x1</td><td colspan="2">x2</td><td>x2_1</td><td colspan="3">x2_2</td><td>x2_2 end flag</td><td>x3_1</td><td colspan="2">x4[0]</td><td colspan="2">x4[1]</td><td colspan="2">x4[2]</td><td>x4 end flag</td><td>x4_1</td><td>x5.a</td><td colspan="3">x5.b</td><td>x5.c</td><td>x5_1</td><td colspan="5">x7[0]</td><td colspan="5">x7[1]</td><td>x7 end flag</td><td>x7_1</td><td colspan="4">x8_0</td><td>x8_0 end flag</td><td>x8</td></tr><tr align="center"><td></td><td>1</td><td>10</td><td>20</td><td>21</td><td>x2_1</td><td>2</td><td>3</td><td>4</td><td>}</td><td>x3_1</td><td>11</td><td>12</td><td>21</td><td>22</td><td>32</td><td>32</td><td>}</td><td>x4_1</td><td>100</td><td>aaa</td><td>bbbb</td><td>}</td><td>true</td><td>x5_1</td><td>100</td><td>aaa1</td><td>bbbb1</td><td>}</td><td>true</td><td>200</td><td>aaa2</td><td>bbbb2</td><td>}</td><td>false</td><td>}</td><td>x7_1</td><td>1</td><td>100</td><td>2</td><td>200</td><td>}</td><td>1234</td></tr></table></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sep-介绍">sep 介绍<a href="#sep-介绍" class="hash-link" aria-label="Direct link to sep 介绍" title="Direct link to sep 介绍">​</a></h2><p>流式格式中，对于包含多个数据的复合类型数据，有时候希望紧凑地在一个单元格内填写它的多个子数据，使用sep可以实现此目的。</p><p>由于sep非常常见，而且用法复杂多样，因此在单独的文档 <a href="/en/docs/classic/manual/excelsep">excel sep格式介绍</a>中介绍</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="原生数据类型">原生数据类型<a href="#原生数据类型" class="hash-link" aria-label="Direct link to 原生数据类型" title="Direct link to 原生数据类型">​</a></h2><p>支持 bool,int,float,string,vector2,vector3,vector4 等等类型，它们的填写跟常规认知一致。</p><table><thead><tr><th>##var</th><th>x1</th><th>x3</th><th>x4</th><th>x5</th><th>x6</th><th>x7</th><th>s1</th><th>v2</th><th>v3</th><th>v4</th></tr></thead><tbody><tr><td>##type</td><td>bool</td><td>short</td><td>int</td><td>long</td><td>float</td><td>double</td><td>string</td><td>vector2</td><td>vector3</td><td>vector4</td></tr><tr><td>##</td><td>desc1</td><td>id</td><td>desc4</td><td>desc5</td><td>desc6</td><td>desc7</td><td>desc1</td><td>desc2</td><td>desc3</td><td>desc4</td></tr><tr><td></td><td>false</td><td>10</td><td>100</td><td>1000</td><td>1.23</td><td>1.2345</td><td>hello</td><td>1,2</td><td>1,2,3</td><td>1,2,3,4</td></tr><tr><td></td><td>true</td><td>20</td><td>200</td><td>1000</td><td>1.23</td><td>1.2345</td><td>world</td><td>1,2</td><td>1,2,3</td><td>1,2,3,4</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="text-类型">text 类型<a href="#text-类型" class="hash-link" aria-label="Direct link to text 类型" title="Direct link to text 类型">​</a></h2><p>该类型数据包含两个字段, key和text， 其中 key 可以重复出现，但要求text完全相同，否则报错。这么设计是为了防止意外写重了key。<strong>注意：不允许key为空而text不为空</strong></p><p>如果想填空的本地化字符串， key和text完全留空即可，工具会特殊对待，不会加入 key集合。</p><p>text的key和text字段都是string类型，因此在连续单元格或者sep产生的连续数据流模式中，同样要遵循用&quot;&quot;来表达空白字符串的规则。</p><table><thead><tr><th>##var</th><th>id</th><th>x</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>text#sep=,</td></tr><tr><td></td><td>1</td><td>/demo/key1,aaaa</td></tr><tr><td></td><td>2</td><td>/demo/key2,bbbb</td></tr><tr><td></td><td>3</td><td></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="datetime-类型">datetime 类型<a href="#datetime-类型" class="hash-link" aria-label="Direct link to datetime 类型" title="Direct link to datetime 类型">​</a></h2><p>时间是常用的数据类型。Luban 特地提供了支持。  </p><ul><li>以纯字符串方式填写，填写格式为 以下 4 种。<ul><li>yyyy-mm-dd hh:mm:ss 如 1999-08-08 01:30:29</li><li>yyyy-mm-dd hh:mm 如 2000-08-07 07:40</li><li>yyyy-mm-dd hh 如 2001-09-05 07</li><li>yyyy-mm-dd 如 2003-04-05</li></ul></li><li>以 excel内置的时间格式填写</li></ul><table><thead><tr><th>##var</th><th>id</th><th>x</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>datetime</td></tr><tr><td></td><td>1</td><td>1999-09-09 01:02:03</td></tr><tr><td></td><td>2</td><td>1999-09-09 01:02</td></tr><tr><td></td><td>3</td><td>1999-09-09 01</td></tr><tr><td></td><td>4</td><td>1999-09-09</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="可空变量">可空变量<a href="#可空变量" class="hash-link" aria-label="Direct link to 可空变量" title="Direct link to 可空变量">​</a></h2><p>有时候会有一种变量，我们希望它 功能生效时填一个有效值，功能不生效里，用一个值来表示。 例如 int 类型，常常拿 0 或者-1 作无效值常量。 但有时候，0 或-1 也是有效值时，这种做法就不生效了。或者说 项目组内 有时候拿 0，有时候拿-1 作无效值标记，很不统一。我们借鉴 sql 及 c#,引入 可空值概念，用 null 表达空值。</p><table><thead><tr><th>##var</th><th>id</th><th>x</th><th>color</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>int?</td><td>QualityColor?</td></tr><tr><td></td><td>1</td><td>1</td><td>A</td></tr><tr><td></td><td>2</td><td>null</td><td>B</td></tr><tr><td></td><td>3</td><td>2</td><td>null</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="向量类型-vector2vector3vector4">向量类型 vector2,vector3,vector4<a href="#向量类型-vector2vector3vector4" class="hash-link" aria-label="Direct link to 向量类型 vector2,vector3,vector4" title="Direct link to 向量类型 vector2,vector3,vector4">​</a></h2><p>vector3 有三个字段 float x, float y, float z, 适合用于表示坐标之类的数据。</p><table><thead><tr><th>##var</th><th>id</th><th>x2</th><th>x3</th><th>x4</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>vector2</td><td>vector3</td><td>vector4</td></tr><tr><td></td><td>1</td><td>1,2</td><td>11,22,33</td><td>12,33,44,55</td></tr><tr><td></td><td>2</td><td>2,3</td><td>22,44,55</td><td>6.5,4.7,8.9</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="原生数据列表">原生数据列表<a href="#原生数据列表" class="hash-link" aria-label="Direct link to 原生数据列表" title="Direct link to 原生数据列表">​</a></h2><table border="1"><tr align="center"><td>##var</td><td>id</td><td>arr1</td><td colspan="4">arr2</td><td>arr3</td><td colspan="3">arr4</td></tr><tr align="center"><td>##type</td><td>int</td><td>(array#sep=;),int</td><td colspan="4">list,int</td><td>(list#sep=|),string</td><td colspan="3">list,string</td></tr><tr align="center"><td>##</td><td>id</td><td>desc1</td><td colspan="4">desc2</td><td>desc3</td><td colspan="3">desc4</td></tr><tr align="center"><td></td><td>1</td><td>1;2;3</td><td>1</td><td>2</td><td></td><td></td><td>xx|yy</td><td>xxx</td><td>zzz</td><td></td></tr><tr align="center"><td></td><td>2</td><td>2;4</td><td>3</td><td>4</td><td>5</td><td></td><td>aaaa|bbbb|cccc</td><td>aaa</td><td>bbb</td><td>ccc</td></tr><tr align="center"><td></td><td>3</td><td>2;4;6</td><td>3</td><td>4</td><td>5</td><td>6</td><td>aaaa|bbbb|cccc</td><td>aaa</td><td>bbb</td><td>ccc</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="枚举">枚举<a href="#枚举" class="hash-link" aria-label="Direct link to 枚举" title="Direct link to 枚举">​</a></h2><p>以枚举名或者别名或者值的方式填写枚举值。</p><p>在xml中定义</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">enum</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ItemQuality</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">WHITE</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">白</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">GREEN</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">绿</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">RED</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">红</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">enum</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者在 <!-- -->_<!-- -->_<!-- -->enums<!-- -->_<!-- -->_<!-- -->.xlsx 中 定义</p><table border="1"><tr align="center"><td>##var</td><td>full_name</td><td>flags</td><td>unique</td><td>comment</td><td>tags</td><td colspan="5">*items</td></tr><tr align="center"><td>##var</td><td></td><td></td><td></td><td></td><td></td><td>name</td><td>alias</td><td>value</td><td>comment</td><td>tags</td></tr><tr align="center"><td></td><td>ItemQuality</td><td>false</td><td>true</td><td></td><td></td><td>WHITE</td><td>白</td><td>0</td><td></td><td></td></tr><tr align="center"><td></td><td></td><td></td><td></td><td></td><td></td><td>GREEN</td><td>绿</td><td>1</td><td></td><td></td></tr><tr align="center"><td></td><td></td><td></td><td></td><td></td><td></td><td>RED</td><td>红</td><td>2</td><td></td><td></td></tr></table><p>数据表如下</p><table><thead><tr><th>##var</th><th>id</th><th>quality</th><th>quality2</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>ItemQuality</td><td>ItemQuality</td></tr><tr><td></td><td>1</td><td>白</td><td>RED</td></tr><tr><td></td><td>2</td><td>GREEN</td><td>红</td></tr><tr><td></td><td>3</td><td>RED</td><td>WHITE</td></tr><tr><td></td><td>4</td><td>1</td><td>0</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="嵌套子结构">嵌套子结构<a href="#嵌套子结构" class="hash-link" aria-label="Direct link to 嵌套子结构" title="Direct link to 嵌套子结构">​</a></h2><p>经常会碰到，某个字段是结构，尤其这个结构在很多配置里都会复用。</p><p>假设任务中包含一个 奖励信息 字段</p><p>在xml中定义</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Reward</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者在 <!-- -->_<!-- -->_<!-- -->beans<!-- -->_<!-- -->_<!-- -->.xlsx 里定义</p><table border="1"><tr align="center"><td>##var</td><td>full_name</td><td>sep</td><td>comment</td><td colspan="5">fields</td>  </tr><tr align="center"><td>##var</td><td></td><td></td><td></td><td>name</td><td>type</td><td>group</td><td>comment</td><td>tags</td></tr><tr><td></td><td>Reward</td><td></td><td></td><td>item_id</td><td>int</td><td></td><td>道具id</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>count</td><td>int</td><td></td><td>个数</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>desc</td><td>string</td><td></td><td>描述</td><td></td></tr></table><p>数据表如下</p><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="3">reward</td></tr><tr align="center"><td>##type</td><td>int</td><td colspan="3">Reward</td></tr><tr align="center"><td>##</td><td>id</td><td>道具id</td><td>个数</td><td>描述</td></tr><tr align="center"><td></td><td>1</td><td>1001</td><td>1</td><td>desc1</td></tr><tr align="center"><td></td><td>2</td><td>1002</td><td>100</td><td>desc2</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="简单结构列表">简单结构列表<a href="#简单结构列表" class="hash-link" aria-label="Direct link to 简单结构列表" title="Direct link to 简单结构列表">​</a></h2><p>某个字段为结构列表的情形也很常见，比如说奖励信息列表包含多个奖励信息，每个奖励都有多个字段。</p><p>假设礼包中包含一个道具信息列表字段。支持3种填写模式，具体选择由策划灵活决定。</p><ul><li>所有字段完全展开，每个单元格填一个元素。缺点是占用的列较多。如items1字段。</li><li>每个结构占据一个单元格，使用sep分割结构子字段。如items2字段。</li><li>整个列表占据一个单元格，使用sep分割列表及结构子字段。如items3字段。</li></ul><p>xml中定义如下</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Reward</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者也可以在<!-- -->_<!-- -->_<!-- -->beans<!-- -->_<!-- -->_<!-- -->.xlsx中定义，此处不再赘述，==<strong>后面的涉及到结构定义的例子都只给xml的示例</strong>==。</p><p>数据表如下：</p><div class="Excel"><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="6">rewards1</td><td colspan="3">rewards2</td><td>rewards3</td></tr><tr align="center"><td>##type</td><td>int</td><td colspan="6">list,Reward</td><td colspan="3">list,Reward#sep=,</td><td>(list#sep=|),Reward#sep=,</td></tr><tr align="center"><td>##</td><td>id</td><td colspan="6">reward list desc1</td><td colspan="3">reward list desc2</td><td>reward list desc3</td></tr><tr align="center"><td></td><td>1</td><td>1001</td><td>1</td><td>desc1</td><td>1002</td><td>2</td><td>desc2</td><td>1001,1,desc1</td><td>1002,2,desc2</td><td>1003,3,desc3</td><td>1001,1,desc1|1002,2,desc2</td></tr><tr align="center"><td></td><td>2</td><td>1001</td><td>1</td><td>desc1</td><td></td><td></td><td></td><td>1001,1,desc1</td><td>1002,2,desc2</td><td></td><td>1001,1,desc1|1002,2,desc2|1003,1,desc3</td></tr></table></div><p>或者可以用多级标题头对每个元素单独限定</p><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="9">rewards</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="9">list,Reward</td></tr><tr align="center"><td>##var</td><td></td><td></td><td colspan="3">0</td><td colspan="3">1</td><td colspan="3">2</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>item_id</td><td>num</td><td>desc</td><td>item_id</td><td>num</td><td>desc</td><td>item_id</td><td>num</td><td>desc</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>10</td><td>desc1</td><td>2</td><td>12</td><td>desc2</td><td>3</td><td>13</td><td>desc3</td></tr><tr align="center"><td></td><td>2</td><td>task1</td><td>3</td><td>30</td><td>desc3</td><td>4</td><td>40</td><td>desc4</td><td></td><td></td><td></td></tr><tr align="center"><td></td><td>3</td><td>task1</td><td>5</td><td>50</td><td>desc5</td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多行结构列表">多行结构列表<a href="#多行结构列表" class="hash-link" aria-label="Direct link to 多行结构列表" title="Direct link to 多行结构列表">​</a></h2><p>有时候列表结构的每个结构字段较多，如果水平展开则占据太多列，不方便编辑，如果拆表，无论程序还是策划都不方便，此时可以使用多行模式。支持任意层次的多行结构列表（也即多行结构中的每个元素也可以是多行）， name#multi_rows=1或者*name 都可以表达一个多行解析的字段。</p><p>假设每个任务包含多个阶段，有一个阶段列表字段。</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Stage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">name</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">location</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">vector3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">reward_item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">reward_item_count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="6">*stage2</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="6">list,Stage</td></tr><tr align="center"><td>##</td><td>id</td><td>desc</td><td colspan="6">stage info</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>3</td><td>stage3</td><td>stage desc3</td><td>1,2,3</td><td>1002</td><td>1</td></tr><tr align="center"><td></td><td>2</td><td>task2</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1002</td><td>1</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="列表表-无主键">列表表 （无主键）<a href="#列表表-无主键" class="hash-link" aria-label="Direct link to 列表表 （无主键）" title="Direct link to 列表表 （无主键）">​</a></h2><p>有时候只想得到一个记录列表，无主键。mode=&quot;list&quot;并且index为空，表示无主键表。</p><p>定义表</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">table</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">TbNotKeyList</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">NotKeyList</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">mode</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">list</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">input</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">not_key_list.xlsx</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>示例数据表</p><table><thead><tr><th>##var</th><th>x</th><th>y</th><th>z</th><th>num</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>long</td><td>string</td><td>int</td></tr><tr><td></td><td>1</td><td>1</td><td>aaa</td><td>123</td></tr><tr><td></td><td>1</td><td>1</td><td>bbb</td><td>124</td></tr><tr><td></td><td>1</td><td>2</td><td>aaa</td><td>134</td></tr><tr><td></td><td>2</td><td>1</td><td>aaa</td><td>124</td></tr><tr><td></td><td>5</td><td>6</td><td>xxx</td><td>898</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多主键表联合索引">多主键表（联合索引）<a href="#多主键表联合索引" class="hash-link" aria-label="Direct link to 多主键表（联合索引）" title="Direct link to 多主键表（联合索引）">​</a></h2><p>多个key构成联合唯一主键。使用&quot;+&quot;分割key，表示联合关系。</p><p>定义表</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">table</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">TbUnionMultiKey</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">UnionMultiKey</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">index</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">key1+key2+key3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">input</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">union_multi_key.xlsx</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>示例数据表</p><table><thead><tr><th>##var</th><th>key1</th><th>key2</th><th>key3</th><th>num</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>long</td><td>string</td><td>int</td></tr><tr><td></td><td>1</td><td>1</td><td>aaa</td><td>123</td></tr><tr><td></td><td>1</td><td>1</td><td>bbb</td><td>124</td></tr><tr><td></td><td>1</td><td>2</td><td>aaa</td><td>134</td></tr><tr><td></td><td>2</td><td>1</td><td>aaa</td><td>124</td></tr><tr><td></td><td>5</td><td>6</td><td>xxx</td><td>898</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多主键表独立索引">多主键表（独立索引）<a href="#多主键表独立索引" class="hash-link" aria-label="Direct link to 多主键表（独立索引）" title="Direct link to 多主键表（独立索引）">​</a></h2><p>多个key，各自独立唯一索引。与联合索引写法区别在于使用 &quot;,&quot;来划分key，表示独立关系。</p><p>定义表</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">table</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">TbMultiKey</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">MultiKey</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">index</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">key1,key2,key3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">input</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">multi_key.xlsx</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>示例数据表</p><table><thead><tr><th>##var</th><th>key1</th><th>key2</th><th>key3</th><th>num</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>long</td><td>string</td><td>int</td></tr><tr><td></td><td>1</td><td>2</td><td>aaa</td><td>123</td></tr><tr><td></td><td>2</td><td>4</td><td>bbb</td><td>124</td></tr><tr><td></td><td>3</td><td>6</td><td>ccc</td><td>134</td></tr><tr><td></td><td>4</td><td>8</td><td>ddd</td><td>124</td></tr><tr><td></td><td>5</td><td>1</td><td>eee</td><td>898</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="单例表">单例表<a href="#单例表" class="hash-link" aria-label="Direct link to 单例表" title="Direct link to 单例表">​</a></h2><p>有一些配置全局只有一份，比如 公会模块的开启等级，背包初始大小，背包上限。此时使用单例表来配置这些数据比较合适。</p><table><thead><tr><th>##var</th><th>guld_open_level</th><th>bag_init_capacity</th><th>bag_max_capacity</th><th>newbie_tasks</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>int</td><td>int</td><td>list,int</td></tr><tr><td>##</td><td>desc1</td><td>desc 2</td><td>desc 3</td><td>desc 4</td></tr><tr><td></td><td>10</td><td>100</td><td>500</td><td>10001,10002</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="纵表">纵表<a href="#纵表" class="hash-link" aria-label="Direct link to 纵表" title="Direct link to 纵表">​</a></h2><p>大多数表都是横表，即一行一个记录。有些表，比如单例表，如果纵着填，一行一个字段，会比较舒服。A1为##column表示使用纵表模式。 上面的单例表，以纵表模式填如下。</p><table border="1"><tr align="center"><td>##var#column</td><td>##type</td><td>##</td><td></td></tr><tr align="center"><td>guild_open_level</td><td>int</td><td>desc1</td><td>10</td></tr><tr align="center"><td>bag_init_capacity</td><td>int</td><td>desc2</td><td>100</td></tr><tr align="center"><td>bag_max_capacity</td><td>int</td><td>desc3</td><td>500</td></tr><tr align="center"><td>newbie_tasks</td><td>(list#sep=,),int</td><td>desc4</td><td>10001,10002</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="引用检查">引用检查<a href="#引用检查" class="hash-link" aria-label="Direct link to 引用检查" title="Direct link to 引用检查">​</a></h2><p>游戏配置中经常要填写诸如道具id之类的外键数据，这些数据必须是合法的id值，luban支持生成时检查id的合法性，如果有误，则打出警告。不只是表顶层字段，列表及嵌套结构的子字段也支持完整的引用检查。</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Reward</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">ref</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">item.TbItem</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table border="1"><tr align="center"><td>##var</td><td>id</td><td>item_id</td><td>items</td><td colspan="3">reward</td><td colspan="3">rewards</td></tr><tr align="center"><td>##type</td><td>int</td><td>int#ref=item.TbItem</td><td>list,int#ref=item.TbItem</td><td colspan="3">Reward</td><td colspan="3">list,Reward#sep=,</td></tr><tr align="center"><td>##</td><td>id</td><td>desc1</td><td>desc2</td><td colspan="3">desc3</td><td colspan="3">desc4</td></tr><tr align="center"><td></td><td>1</td><td>1001</td><td>1001,1002</td><td>1001</td><td>10</td><td>item1</td><td>1001,10,item1</td><td>1002,2,item2</td><td></td></tr><tr align="center"><td></td><td>2</td><td>1002</td><td>1003,1004,1005</td><td>1002</td><td>10</td><td>item2</td><td>1004,10,item4</td><td>1005,2,item5</td><td>1010,1,item10</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="资源检查">资源检查<a href="#资源检查" class="hash-link" aria-label="Direct link to 资源检查" title="Direct link to 资源检查">​</a></h2><p>配置中经常要填写资源路径，比如道具icon的资源，这些数据都是string类型，非常容易填写出错，导致运行时无法正常显示。luban支持unity与ue4资源的合法性检查以及通用型文件路径检查。不只是表顶层字段，列表及嵌套结构的子字段也支持完整的引用检查。</p><p>对于这些字段添加属性 path=unity或者path=ue或path=normal;xxxx。</p><table><thead><tr><th>##var</th><th>id</th><th>icon</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>string#path=unity</td></tr><tr><td>##</td><td>id</td><td>icon desc</td></tr><tr><td></td><td>1</td><td>Assets/UI/item1.jpg</td></tr><tr><td></td><td>2</td><td>Assets/UI/item2.jpg</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="分组导出">分组导出<a href="#分组导出" class="hash-link" aria-label="Direct link to 分组导出" title="Direct link to 分组导出">​</a></h2><p>灵活的分组定义，不仅仅是client和server分组。支持以下分组粒度：</p><ul><li>表级别分组</li><li>字段级别分组(任意bean字段粒度，而不仅限于顶层字段)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据标签过滤">数据标签过滤<a href="#数据标签过滤" class="hash-link" aria-label="Direct link to 数据标签过滤" title="Direct link to 数据标签过滤">​</a></h2><p>开发期经常会制作一些仅供开发使用的配置，比如测试道具，比如自动化测试使用的配置，希望在正式发布时不导出这些数据。</p><table><thead><tr><th>##var</th><th>id</th><th>name</th><th></th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>string</td><td></td></tr><tr><td>##</td><td>id</td><td>desc1</td><td>注释</td></tr><tr><td></td><td>1</td><td>item1</td><td>永远导出</td></tr><tr><td>##</td><td>2</td><td>item2</td><td>永远不导出</td></tr><tr><td>test</td><td>4</td><td>item4</td><td>--export_exclude_tags test 时不导出</td></tr><tr><td>TEST</td><td>5</td><td>item5</td><td>--export_exclude_tags test 时不导出</td></tr><tr><td>dev</td><td>6</td><td>item6</td><td>--export_exclude_tags dev 时不导出</td></tr><tr><td></td><td>7</td><td>item7</td><td>永远导出</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多行记录填写">多行记录填写<a href="#多行记录填写" class="hash-link" aria-label="Direct link to 多行记录填写" title="Direct link to 多行记录填写">​</a></h2><p>目前只对容器类型字段支持多行。字段名前加<em>,如</em>stages,或者添加multi_rows=1参数也行，如stages#multi_rows=1。
一旦标记字段为多行，每行会作为字段的一个元素读入，例如 list,bean类型，则每行读入一个bean结构。</p><p>多行可以嵌套，即多行字段中，某个字段本身也可以是多行记录。 示例可参见<a href="https://github.com/focus-creative-games/luban_examples/blob/main/DataTables/Datas/test/multi_rows_record.xlsx" target="_blank" rel="noopener noreferrer">multi_rows_record</a></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Stage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">name</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">desc</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">string</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">location</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">vector3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">reward_item_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">reward_item_count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">int</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="6">*stages</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="6">list,Stage</td></tr><tr align="center"><td>##</td><td>id</td><td>desc</td><td colspan="6">stage info</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>3</td><td>stage3</td><td>stage desc3</td><td>1,2,3</td><td>1002</td><td>1</td></tr><tr align="center"><td></td><td>2</td><td>task2</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1002</td><td>1</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="层级标题头-hierarchy-title">层级标题头 (hierarchy title)<a href="#层级标题头-hierarchy-title" class="hash-link" aria-label="Direct link to 层级标题头 (hierarchy title)" title="Direct link to 层级标题头 (hierarchy title)">​</a></h2><p>在多行数据或者深层次嵌套的数据中，如果数据字段较多，填写时不易区分子元素。luban提供层级标题实现深层次的子字段对应。以上面的多行数据列表为例,第一列为##var表示这是个子字段行。</p><ul><li>普通bean结构的子标题</li></ul><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="5">stage</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="5">Stage</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>name</td><td>desc</td><td>location</td><td>item_id</td><td>num</td></tr><tr align="center"><td>##</td><td>id</td><td>name</td><td>desc2</td><td>desc3</td><td>desc4</td><td>desc5</td><td>desc6</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td>2</td><td>task2</td><td>stage2</td><td>stage desc2</td><td>3,4,5</td><td>2001</td><td>3</td></tr></table><ul><li>list,bean 的多行展开多级子标题</li></ul><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="6">*stages</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="6">list,Stage</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>id</td><td>name</td><td>desc</td><td>location</td><td>item_id</td><td>num</td></tr><tr align="center"><td>##</td><td>id</td><td>desc1</td><td>desc1</td><td>desc2</td><td>desc3</td><td>desc4</td><td>desc5</td><td>desc6</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>3</td><td>stage3</td><td>stage desc3</td><td>1,2,3</td><td>1002</td><td>1</td></tr><tr align="center"><td></td><td>2</td><td>task2</td><td>1</td><td>stage1</td><td>stage desc1</td><td>1,2,3</td><td>1001</td><td>1</td></tr><tr align="center"><td></td><td></td><td></td><td>2</td><td>stage2</td><td>stage desc2</td><td>1,2,3</td><td>1002</td><td>1</td></tr></table><ul><li>list,bean 的水平展开多级子标题</li></ul><table border="1"><tr align="center"><td>##var</td><td>id</td><td>name</td><td colspan="9">items</td></tr><tr align="center"><td>##type</td><td>int</td><td>string</td><td colspan="9">list,Item</td></tr><tr align="center"><td>##var</td><td></td><td></td><td colspan="3">0</td><td colspan="3">1</td><td colspan="3">2</td></tr><tr align="center"><td>##var</td><td></td><td></td><td>item_id</td><td>num</td><td>desc</td><td>item_id</td><td>num</td><td>desc</td><td>item_id</td><td>num</td><td>desc</td></tr><tr align="center"><td></td><td>1</td><td>task1</td><td>1</td><td>10</td><td>desc1</td><td>2</td><td>12</td><td>desc2</td><td>3</td><td>13</td><td>desc3</td></tr><tr align="center"><td></td><td>2</td><td>task1</td><td>3</td><td>30</td><td>desc3</td><td>4</td><td>40</td><td>desc4</td><td></td><td></td><td></td></tr><tr align="center"><td></td><td>3</td><td>task1</td><td>5</td><td>50</td><td>desc5</td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table><ul><li>map 类型的多级子标题</li></ul><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="4">lans</td></tr><tr align="center"><td>##type</td><td>int</td><td colspan="4">map,string,string</td></tr><tr align="center"><td>##var</td><td></td><td>ch-zn</td><td>en</td><td>jp</td><td>fr</td></tr><tr align="center"><td></td><td>1</td><td>苹果</td><td>apple</td><td>aaa</td><td>aaa</td></tr><tr align="center"><td></td><td>2</td><td>香蕉</td><td>banana</td><td>bbb</td><td>bbb</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多态结构">多态结构<a href="#多态结构" class="hash-link" aria-label="Direct link to 多态结构" title="Direct link to 多态结构">​</a></h2><p>示例定义如下</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Shape</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Circle</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">radius</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Rectangle</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">长方形</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">width</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">height</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Curve</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Line</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">直线</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">param_a</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">param_b</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Parabola</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">抛物线</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">param_a</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">param_b</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">float</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bean</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table border="1"><tr align="center"><td>##var</td><td>id</td><td colspan="4">shapes</td></tr><tr align="center"><td>##type</td><td>int</td><td colspan="4">list,Shape#sep=,</td></tr><tr align="center"><td>##</td><td>id</td><td colspan="4"> shape desc</td></tr><tr align="center"><td></td><td>1</td><td>Circle,10</td><td>Rectangle,100,200</td><td></td><td></td></tr><tr align="center"><td></td><td>2</td><td>Circle,20</td><td>Rectangle,100,200</td><td>Line,5,8</td><td>Parabola,15,30</td></tr></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="字段默认值">字段默认值<a href="#字段默认值" class="hash-link" aria-label="Direct link to 字段默认值" title="Direct link to 字段默认值">​</a></h2><p>我们希望excel中单元格留空时，该字段取指定值，而不是默认的false,0之类。通过定义字段的default=xxx属性来指定默认值。</p><p>如示例，id=2的记录，x1与x2皆为空，x1=0,x2=-1。</p><table><thead><tr><th>##var</th><th>id</th><th>x1</th><th>x2#default=-1</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>int</td><td>int</td></tr><tr><td>##</td><td>id</td><td>desc1</td><td>desc2</td></tr><tr><td></td><td>1</td><td>10</td><td>20</td></tr><tr><td></td><td>2</td><td></td><td></td></tr><tr><td></td><td>3</td><td></td><td>30</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="常量别名">常量别名<a href="#常量别名" class="hash-link" aria-label="Direct link to 常量别名" title="Direct link to 常量别名">​</a></h2><p>游戏里经常会出现一些常用的类似枚举的值，比如说 升级丹的 id,在很多地方都要填，如果直接它的道具 id,既不直观，也容易出错。 Luban 支持常量替换。如示例，导出时SHENG_JI_DAN会被替换为11220304。</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">enum</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">EFunctionItemId</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">SHENG_JI_DAN</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">升级丹</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">11220304</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">var</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">JIN_JIE_DAN</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alias</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">进阶丹</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">11220506</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">enum</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>##var</th><th>id</th><th>item_id</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>int#convert=EFunctionItemId</td></tr><tr><td>##</td><td>id</td><td>desc</td></tr><tr><td></td><td>1</td><td>SHENG_JI_DAN</td></tr><tr><td></td><td>2</td><td>进阶丹</td></tr><tr><td></td><td>3</td><td>1001</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="单元格取非0默认值">单元格取非0默认值<a href="#单元格取非0默认值" class="hash-link" aria-label="Direct link to 单元格取非0默认值" title="Direct link to 单元格取非0默认值">​</a></h2><p>只对excel格式有效。在字段名上加上 xxx#default=value，则所有留空的单元格都会自动取value。如下图，id=2的记录，count=10,desc=haha。 default是excel格式特有属性，它作用于列，必须填在<strong>字段名</strong>上。</p><table><thead><tr><th>##var</th><th>id</th><th>count#default=10</th><th>desc#default=haha</th></tr></thead><tbody><tr><td>##type</td><td>int</td><td>int</td><td>string</td></tr><tr><td></td><td>1</td><td>1</td><td>abc</td></tr><tr><td></td><td>2</td><td></td><td></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/classic/manual/define"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">配置定义</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/classic/manual/loadconfigatruntime"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">运行时加载配置</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#创建一个普通的xlsx-配置表" class="table-of-contents__link toc-highlight">创建一个普通的xlsx 配置表</a></li><li><a href="#excel-标题头行的介绍" class="table-of-contents__link toc-highlight">excel 标题头行的介绍</a></li><li><a href="#注释行或列" class="table-of-contents__link toc-highlight">注释行或列</a></li><li><a href="#excel文件-读取规则" class="table-of-contents__link toc-highlight">excel文件 读取规则</a></li><li><a href="#支持的excel文件族" class="table-of-contents__link toc-highlight">支持的excel文件族</a></li><li><a href="#支持非gkb和utf-8编码的csv文件" class="table-of-contents__link toc-highlight">支持非GKB和UTF-8编码的csv文件</a></li><li><a href="#灵活的配置文件组织形式" class="table-of-contents__link toc-highlight">灵活的配置文件组织形式</a></li><li><a href="#单元格留空取默认值" class="table-of-contents__link toc-highlight">单元格留空取默认值</a></li><li><a href="#数据格式" class="table-of-contents__link toc-highlight">数据格式</a></li><li><a href="#限定列格式与流式格式" class="table-of-contents__link toc-highlight">限定列格式与流式格式</a></li><li><a href="#限定列格式介绍" class="table-of-contents__link toc-highlight">限定列格式介绍</a><ul><li><a href="#flags1-的-enum-类型支持列限定模式" class="table-of-contents__link toc-highlight"><code>flags=1</code> 的 enum 类型支持列限定模式。</a></li><li><a href="#多态bean支持-type与value-分别配置的列限定或流式格式的混合填写方式" class="table-of-contents__link toc-highlight">多态bean支持 $type与$value 分别配置的列限定或流式格式的混合填写方式</a></li></ul></li><li><a href="#流式格式介绍" class="table-of-contents__link toc-highlight">流式格式介绍</a></li><li><a href="#sep-介绍" class="table-of-contents__link toc-highlight">sep 介绍</a></li><li><a href="#原生数据类型" class="table-of-contents__link toc-highlight">原生数据类型</a></li><li><a href="#text-类型" class="table-of-contents__link toc-highlight">text 类型</a></li><li><a href="#datetime-类型" class="table-of-contents__link toc-highlight">datetime 类型</a></li><li><a href="#可空变量" class="table-of-contents__link toc-highlight">可空变量</a></li><li><a href="#向量类型-vector2vector3vector4" class="table-of-contents__link toc-highlight">向量类型 vector2,vector3,vector4</a></li><li><a href="#原生数据列表" class="table-of-contents__link toc-highlight">原生数据列表</a></li><li><a href="#枚举" class="table-of-contents__link toc-highlight">枚举</a></li><li><a href="#嵌套子结构" class="table-of-contents__link toc-highlight">嵌套子结构</a></li><li><a href="#简单结构列表" class="table-of-contents__link toc-highlight">简单结构列表</a></li><li><a href="#多行结构列表" class="table-of-contents__link toc-highlight">多行结构列表</a></li><li><a href="#列表表-无主键" class="table-of-contents__link toc-highlight">列表表 （无主键）</a></li><li><a href="#多主键表联合索引" class="table-of-contents__link toc-highlight">多主键表（联合索引）</a></li><li><a href="#多主键表独立索引" class="table-of-contents__link toc-highlight">多主键表（独立索引）</a></li><li><a href="#单例表" class="table-of-contents__link toc-highlight">单例表</a></li><li><a href="#纵表" class="table-of-contents__link toc-highlight">纵表</a></li><li><a href="#引用检查" class="table-of-contents__link toc-highlight">引用检查</a></li><li><a href="#资源检查" class="table-of-contents__link toc-highlight">资源检查</a></li><li><a href="#分组导出" class="table-of-contents__link toc-highlight">分组导出</a></li><li><a href="#数据标签过滤" class="table-of-contents__link toc-highlight">数据标签过滤</a></li><li><a href="#多行记录填写" class="table-of-contents__link toc-highlight">多行记录填写</a></li><li><a href="#层级标题头-hierarchy-title" class="table-of-contents__link toc-highlight">层级标题头 (hierarchy title)</a></li><li><a href="#多态结构" class="table-of-contents__link toc-highlight">多态结构</a></li><li><a href="#字段默认值" class="table-of-contents__link toc-highlight">字段默认值</a></li><li><a href="#常量别名" class="table-of-contents__link toc-highlight">常量别名</a></li><li><a href="#单元格取非0默认值" class="table-of-contents__link toc-highlight">单元格取非0默认值</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Document</a></li></ul></div><div class="col footer__col"><div class="footer__title">Repository</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/focus-creative-games/luban_examples" target="_blank" rel="noopener noreferrer" class="footer__link-item">luban_examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/focus-creative-games/Excel2TextDiff" target="_blank" rel="noopener noreferrer" class="footer__link-item">Excel2TextDiff<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/focus-creative-games/hybridclr" target="_blank" rel="noopener noreferrer" class="footer__link-item">hybridclr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 <a href="https://code-philosophy.com/">Code Philosophy</a>. All Rights Reserved.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.6220c242.js"></script>
<script src="/en/assets/js/main.72f07b5a.js"></script>
</body>
</html>