<!doctype html>
<html lang="en-us" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-manual/excelcompactformat">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Excel compact format | Luban</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.datable.cn/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.datable.cn/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.datable.cn/en/docs/manual/excelcompactformat"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Excel compact format | Luban"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://www.datable.cn/en/docs/manual/excelcompactformat"><link data-rh="true" rel="alternate" href="https://www.datable.cn/docs/manual/excelcompactformat" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://www.datable.cn/en/docs/manual/excelcompactformat" hreflang="en-us"><link data-rh="true" rel="alternate" href="https://www.datable.cn/docs/manual/excelcompactformat" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7OJETCEDBD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Luban" href="/en/opensearch.xml"><link rel="stylesheet" href="/en/assets/css/styles.63be808c.css">
<link rel="preload" href="/en/assets/js/runtime~main.8d4de207.js" as="script">
<link rel="preload" href="/en/assets/js/main.f1541476.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Luban</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/intro">Document</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/intro">4.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/manual/excelcompactformat">4.x</a></li><li><a class="dropdown__link" href="/en/docs/3.x/intro">3.x</a></li><li><a class="dropdown__link" href="/en/docs/1.x/intro">1.x</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/manual/excelcompactformat" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">中文</a></li><li><a href="/en/docs/manual/excelcompactformat" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-us">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro">Introduce</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/beginner">The tutorial</a><button aria-label="Toggle the collapsible sidebar category &#x27;The tutorial&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/quickstart">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/generatecodeanddata">Generate Code and Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/integratetoproject">Integrate Luban To Your Project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/loadinruntime">Runtime loading configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/usecustomtype">Use Custom Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/usecollection">Use Container Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/streamandcolumnformat">Column Qualification and Compact Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/usevalidator">Use Data Validator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/usepolymorphismtype">Use Polymorphic types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/beginner/importtable">Automatic Table Import</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/basic">User Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/migrate">Differences from the classic version</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/architecture">design philosophy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/traits">Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/luban.conf">luban.conf</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/schema">schema logical structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/defaultschemacollector">configuration definition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/importtable">Automatic table import</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/commandtools">Command line tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/cascadingoption">Hierarchical parameter mechanism</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/types">type system</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/typemapper">type mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/excel">Excel Format (Primary)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/exceladvanced">Excel Format (Advanced)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/manual/excelcompactformat">Excel compact format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/otherdatasource">Non-Excel data source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/generatecodedata">Code and Data Generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/codestyle">Code Style</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/loadconfigatruntime">Load configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/validator">data validator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/template">custom template</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/tag">data tag</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/variants">Field Variants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/l10n">localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/bestpractices">Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/manual/extendluban">Extended Luban implementation</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/help/faq">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/other">Other</a><button aria-label="Toggle the collapsible sidebar category &#x27;Other&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/basic"><span itemprop="name">User Guide</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Excel compact format</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Excel compact format</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>If a data is non-atomic data (such as beans or containers), and it is limited to certain cell column ranges or is part of the data separated by sep, it is parsed in compact format.</p><p>Before luban v4.0.0, only the stream format is supported as a compact format. Since v4.0.0, the following compact formats are supported:</p><ul><li>Stream format</li><li><strong>lite concise format</strong></li><li>json format</li><li>lua format</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="specify-the-compact-format-used-for-excel-data">Specify the compact format used for excel data<a href="#specify-the-compact-format-used-for-excel-data" class="hash-link" aria-label="Direct link to Specify the compact format used for excel data" title="Direct link to Specify the compact format used for excel data">​</a></h2><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Note that the format attribute is defined on the field name, not on the type!</p></div></div><p>Configure the format attribute on the field header to specify the format for parsing compact data, such as <code>position#format=lite</code>. If no format is specified for the field, the default compact format is stream.</p><p>The compact format has the following types:</p><ul><li><p>stream</p></li><li><p>lite</p></li><li><p>json</p></li><li><p>lua</p></li></ul><p><img loading="lazy" alt="image" src="/en/assets/images/compact-6388075acdb892d9a2987e3fe87e6485.jpg" width="653" height="237" class="img_ev3q"></p><p>The stream format is the most concise when filling in uncomplicated compound data. When the compound data contains complex deeply nested data, the stream format becomes difficult to understand due to the lack of explicit boundaries. At this time, the lite format is clearer and easier to read, and easier to master and use.</p><p>The json format and lua format require field names, and the data is more verbose. It is recommended to use them only in special occasions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-format">Streaming format<a href="#streaming-format" class="hash-link" aria-label="Direct link to Streaming format" title="Direct link to Streaming format">​</a></h2><p>The streaming format is the default compact format, that is, when the <code>format</code> attribute is not specified in the header, the streaming format is used to parse the data. Before luban v4.0.0, only the streaming format is supported.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-format">Data format<a href="#data-format" class="hash-link" aria-label="Direct link to Data format" title="Direct link to Data format">​</a></h3><p>The rules for reading data in streaming format are as follows:</p><ul><li>bool false, true</li><li>int, float and other valid integer values</li><li>string uses &quot;&quot; to represent a string of length 0, and other non-values ​​to represent the value itself</li><li>enum non-null valid values</li><li>bean uses streaming format to read each field in sequence</li><li>Polymorphic bean type First read a string, which can be a specific subclass name or subcategory name, and then read each field of this type in streaming format according to the subclass name.</li><li>Nullable bean type First read a string, if it is the bean type name or &#x27;{}&#x27;, then read all fields of this type in streaming format; if it is null, it means empty and the reading ends; in other cases, it is treated as a non-null bean, starting from the string just read, and read the fields of this type.
Taking the vec3 type as an example, <code>1,2,3</code>, <code>null</code>, <code>{},1,2,3</code>, <code>vec3,1,2,3</code> are all valid data</li><li>array,list,set If the stream ends or the next read is &#x27;}&#x27;, the reading ends, otherwise read element_type in the stream format, and so on.</li><li>map If the stream ends or the next read is &#x27;}&#x27;, the reading ends, otherwise recursively read key_type and value_type, and so on.</li></ul><p>Because the streaming format cannot distinguish between <code>default cells</code> and <code>blank cells</code>, it does not support <strong>default value</strong> semantics and ignores all blank cells. For the default value, you must fill in the valid default value to represent the data, and you cannot leave it blank to express it.</p><p>The example is as follows.</p><p><img loading="lazy" alt="stream" src="/en/assets/images/stream-9322c919c1e2eaeed230ed1c1554079d.jpg" width="755" height="272" class="img_ev3q"></p><p>The two red lines in the figure try to use blank cells to express the default values ​​of bool and string. Since these cells or the zero-length strings separated by sep will be ignored in the streaming format, the parsing error of insufficient data will occur.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sep-segmentation-mechanism">sep segmentation mechanism<a href="#sep-segmentation-mechanism" class="hash-link" aria-label="Direct link to sep segmentation mechanism" title="Direct link to sep segmentation mechanism">​</a></h3><p>We call the data structure containing multiple atomic data elements a composite structure. For a composite structure, if each atomic data occupies a cell, there may be too many columns to read.</p><p>The sep segmentation mechanism can achieve the purpose of filling complex data in one cell.</p><p>The writing method is <code>sep=&lt;char1&gt;&lt;char2&gt;&lt;char3&gt;...</code>. sep can be one character or multiple characters. When sep is multiple characters, it means that any one of them is a separator,
rather than treating multiple characters as separators.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Since the # and &amp; characters are used as delimiters for attrs and tags, if you need to use # or &amp; as literal delimiters, you must escape them with a backslash (<!-- -->)<!-- -->. For example: (list#sep=<!-- -->#<!-- -->),int.</p></div></div><p>sep can appear in the following positions:</p><ul><li>On the field name of Excel. Such as <code>x#sep=,</code></li><li>On the bean tag, such as <code>&lt;bean name=&quot;Item&quot; tag=&quot;sep=,&quot;&gt;</code></li><li>On the tag of the type field of field, such as <code>type=&quot;Vec#sep=,&quot;</code>, <code>type=&quot;(list#sep=|),int&quot;</code>, <code>type=&quot;list,(Vec#sep=,)&quot;</code>, <code>type=&quot;(list#sep=|),(Vec#sep=,)&quot;</code></li></ul><p>When it appears on the excel field name, the sep will be used to automatically split each cell in the column range of the field name to form a data stream, and then the streaming format (described in the following section) will be used to read these data in sequence.</p><p>When it appears on the bean tag, it means that all places where the bean is read will provide the entire bean data in string form, split with the separator and read in streaming format</p><p>When it appears on the type tag, the next data read will be regarded as the overall data corresponding to the type, and then the sep will be used to split the data, and then the data corresponding to the type will be read in streaming format.</p><p>When type is a container, the sep attribute can be applied to itself (such as list) or the element type. If the sep attribute is applied to itself, it means that the next string read in is regarded as the data of the entire container, and sep is used to split the string, and then the contents of the container are read in sequence in a streaming format. If the sep attribute is applied to the element type, each read content is regarded as the data of an element, and sep is used to split the data, and the data corresponding to the element type is read in a streaming format. Repeat this operation until there is no data or the container end character <code>}</code> is encountered.</p><p>Example: Use sep to read beans and nested beans.</p><p><img loading="lazy" alt="sep_bean" src="/en/assets/images/sep_bean-82bc281e78eff8ae7fb8e4b9c0110457.jpg" width="1415" height="192" class="img_ev3q"></p><p>Example: Use sep to read ordinary containers.</p><p><img loading="lazy" alt="sep_bean" src="/en/assets/images/sep_container1-4a8bd3a370e5707614dae98f3fcf51e2.jpg" width="823" height="191" class="img_ev3q"></p><p>Example: Use sep to read structural containers.</p><p><img loading="lazy" alt="sep_bean" src="/en/assets/images/sep_container2-c8fa336d283b22df2d9e7b70742e8558.jpg" width="1261" height="249" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lite-format">lite format<a href="#lite-format" class="hash-link" aria-label="Direct link to lite format" title="Direct link to lite format">​</a></h2><p>Lite is a data format unique to Luban, suitable for expressing very complex nested data structures. The lite format is a format without field names, so it is more concise to fill in than the json and lua formats, and the parsing is more efficient. In practice, it is recommended to use the streaming format for simple composite data and the lite format for complex composite data. Use the json and lua formats only when necessary. For detailed documentation, see <!-- -->[lite format]<!-- -->(./otherdatasource#lite format).</p><p>Use this format to parse data when the format attribute value is specified as lite in the header, such as position#format=lite.</p><p>Format example:</p><ul><li>vec3 data (1.0,2.0,3.0) is filled in as <code>{1.0, 2.0, 3.0}</code>.</li><li><code>class User{ int id; string name; vec3 pos;}</code> is filled in as <code>{1, xxxx, {1,2,3}}</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="json-format">json format<a href="#json-format" class="hash-link" aria-label="Direct link to json format" title="Direct link to json format">​</a></h2><p>Fill in data in json format. For detailed documentation, see <!-- -->[json format]<!-- -->(./otherdatasource#json format).</p><p>Use this format to parse data when the format attribute value is specified as json in the header, such as <code>position#format=json</code>.</p><p>Format example:</p><ul><li><p>vec3 data <code>(1.0,2.0,3.0)</code> is filled in as <code>{&quot;x&quot;:1.0, &quot;y&quot;:2.0, &quot;z&quot;:3.0}</code>.</p></li><li><p><code>class User{ int id; string name; vec3 pos;}</code> is filled in as <code>{&quot;id&quot;:1, &quot;name&quot;:&quot;xxxx&quot;, &quot;pos&quot;:{&quot;x&quot;:1, &quot;y&quot;:2, &quot;z&quot;:3}}</code>.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lua-format">lua format<a href="#lua-format" class="hash-link" aria-label="Direct link to lua format" title="Direct link to lua format">​</a></h2><p>Fill in data in lua format. For detailed documentation, see <!-- -->[lua format]<!-- -->(./otherdatasource#lua format).</p><p>Use this format to parse data when the format attribute value is specified in the header, such as <code>position#format=lua</code>.</p><p>Format example:</p><ul><li>vec3 data <code>(1.0,2.0,3.0)</code> is filled in as <code>{x=1.0, y=2.0, z=3.0}</code> in lua format.</li><li><code>class User{ int id; string name; vec3 pos;}</code> is filled in as <code>{id=1, name=&quot;xxxx&quot;, pos={&quot;x&quot;:1, &quot;y&quot;:2, &quot;z&quot;:3}}</code>.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/manual/exceladvanced"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Excel Format (Advanced)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/manual/otherdatasource"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Non-Excel data source</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#specify-the-compact-format-used-for-excel-data" class="table-of-contents__link toc-highlight">Specify the compact format used for excel data</a></li><li><a href="#streaming-format" class="table-of-contents__link toc-highlight">Streaming format</a><ul><li><a href="#data-format" class="table-of-contents__link toc-highlight">Data format</a></li><li><a href="#sep-segmentation-mechanism" class="table-of-contents__link toc-highlight">sep segmentation mechanism</a></li></ul></li><li><a href="#lite-format" class="table-of-contents__link toc-highlight">lite format</a></li><li><a href="#json-format" class="table-of-contents__link toc-highlight">json format</a></li><li><a href="#lua-format" class="table-of-contents__link toc-highlight">lua format</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Document</a></li></ul></div><div class="col footer__col"><div class="footer__title">Repository</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/focus-creative-games/luban_examples" target="_blank" rel="noopener noreferrer" class="footer__link-item">luban_examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/focus-creative-games/Excel2TextDiff" target="_blank" rel="noopener noreferrer" class="footer__link-item">Excel2TextDiff<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/focus-creative-games/hybridclr" target="_blank" rel="noopener noreferrer" class="footer__link-item">hybridclr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 <a href="https://code-philosophy.com/">Code Philosophy</a>. All Rights Reserved.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.8d4de207.js"></script>
<script src="/en/assets/js/main.f1541476.js"></script>
</body>
</html>