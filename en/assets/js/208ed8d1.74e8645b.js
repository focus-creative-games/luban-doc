"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1740],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,f=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return n?o.createElement(f,i(i({ref:t},p),{},{components:n})):o.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6938:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const r={},i="Runtime loading configuration",l={unversionedId:"beginner/loadinruntime",id:"version-3.x/beginner/loadinruntime",title:"Runtime loading configuration",description:"We have provided a large number of sample projects under Projects.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-3.x/beginner/loadinruntime.md",sourceDirName:"beginner",slug:"/beginner/loadinruntime",permalink:"/en/docs/3.x/beginner/loadinruntime",draft:!1,tags:[],version:"3.x",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Add Luban To Your Project",permalink:"/en/docs/3.x/beginner/addtoproject"},next:{title:"Use Custom Types",permalink:"/en/docs/3.x/beginner/usecustomtype"}},s={},c=[{value:"Install com.code-philosophy.luban",id:"install-comcode-philosophyluban",level:2},{value:"Generate code and configuration",id:"generate-code-and-configuration",level:2},{value:"Load configuration",id:"load-configuration",level:2},{value:"Use configuration",id:"use-configuration",level:2}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"runtime-loading-configuration"},"Runtime loading configuration"),(0,a.kt)("p",null,"We have provided a large number of sample projects under ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects"},"Projects"),"."),(0,a.kt)("p",null,"We take the most common Unity + c# + json as an example, the sample project is ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects/Csharp_Unity_json"},"Csharp_Unity_Json"),",\nFor other types, please refer to the corresponding projects in the Projects directory."),(0,a.kt)("h2",{id:"install-comcode-philosophyluban"},"Install com.code-philosophy.luban"),(0,a.kt)("p",null,"Install the com.code-philosophy.luban package in the Package Manager, the address is ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gitee.com/focus-creative-games/luban_unity.git")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"https://github.com/focus-creative-games/luban_unity.git"),"."),(0,a.kt)("h2",{id:"generate-code-and-configuration"},"Generate code and configuration"),(0,a.kt)("p",null,"Please connect Luban according to the ",(0,a.kt)("a",{parentName:"p",href:"./addtoproject"},"Connect Luban to Project")," document, and prepare the corresponding generation script gen.bat. If you have any questions, you can refer to the ",(0,a.kt)("inlineCode",{parentName:"p"},"gen.bat")," file of the ",(0,a.kt)("inlineCode",{parentName:"p"},"Csharp_Unity_Json")," project."),(0,a.kt)("p",null,"Run the script. If everything goes well, a series of logs will be generated, and the last line is ",(0,a.kt)("inlineCode",{parentName:"p"},"bye~"),"."),(0,a.kt)("admonition",{type:"warning"},(0,a.kt)("p",{parentName:"admonition"},"Luban will delete all other files in the outputCodeDir directory when it is generated. Please provide a separate directory for it. Do not point to the ",(0,a.kt)("inlineCode",{parentName:"p"},"Assets/Scripts")," directory, which will delete other code files! The same applies to outputDataDir.")),(0,a.kt)("h2",{id:"load-configuration"},"Load configuration"),(0,a.kt)("p",null,"All configuration tables can be loaded with just one line of code. Load only once during the entire game (unless you want to reload the configuration during operation). In practice, save the tables after creating them for subsequent use."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'\nstring gameConfDir = "<outputDataDir>"; // Replace with the directory pointed to by outputDataDir in gen.bat\nvar tables = new cfg.Tables(file => JSON.Parse(File.ReadAllText($"{gameConfDir}/{file}.json")));\n\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The default generated code does not support asynchronous loading, and platforms such as Android cannot directly read the StreamingAssets directory, so you need to do some special processing yourself, such as loading all configuration data files into memory before using ",(0,a.kt)("inlineCode",{parentName:"p"},"new Tables")," to load."),(0,a.kt)("p",{parentName:"admonition"},"You can support asynchronous loading by modifying the ",(0,a.kt)("a",{parentName:"p",href:"../manual/template"},"code template"),".")),(0,a.kt)("h2",{id:"use-configuration"},"Use configuration"),(0,a.kt)("p",null,"cfg.Tables contains an instance field of all configuration tables. After loading cfg.Tables, use ",(0,a.kt)("inlineCode",{parentName:"p"},"tables.<table name>")," to get the table instance, and then perform subsequent operations on the table.\nFor example, we want to print the reward information of the Reward table id = 1001, the code is as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'cfg.demo.Reward reward = tables.TbReward.Get(1001);\nConsole.WriteLine("reward:{0}", reward);\n')),(0,a.kt)("p",null,"You may notice that the first letter of the reward table field names id, name, and desc are capitalized. This is because the tool will automatically convert the field names to the corresponding code style according to the output language, that is, boo_bar will be converted to a name like BooBar.\nTherefore, it is recommended to use the xx_yy_zz style when configuring the field names."))}d.isMDXComponent=!0}}]);